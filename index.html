<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #fff7e6 0, #f5f5f5 40%, #eceff1 100%);
            margin: 0;
            padding: 24px;
            color: #263238;
        }

        .container {
            max-width: 440px;
            margin: 40px auto;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 14px 35px rgba(0, 0, 0, 0.08);
            padding: 22px 24px 26px;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: "";
            position: absolute;
            right: -40px;
            top: -40px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at center, rgba(255, 213, 79, 0.4), transparent 60%);
            opacity: 0.7;
            pointer-events: none;
        }

        .card-header {
            margin-bottom: 18px;
        }

        .title-row {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .emoji {
            font-size: 26px;
        }

        h1 {
            font-size: 20px;
            margin: 0;
            letter-spacing: 0.04em;
        }

        .subtitle {
            margin: 8px 0 0;
            font-size: 13px;
            color: #607d8b;
        }

        .field-group {
            margin-top: 10px;
        }

        label {
            display: block;
            font-size: 14px;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .input-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        input[type="date"] {
            flex: 1;
            padding: 8px 10px;
            font-size: 14px;
            border-radius: 8px;
            border: 1px solid #cfd8dc;
            box-sizing: border-box;
            background-color: #fafafa;
            transition: border-color 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
        }

        input[type="date"]:focus {
            outline: none;
            border-color: #ffb74d;
            box-shadow: 0 0 0 2px rgba(255, 183, 77, 0.35);
            background-color: #ffffff;
        }

        button {
            padding: 9px 16px;
            font-size: 14px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, #ffb74d, #fb8c00);
            color: #fff;
            cursor: pointer;
            font-weight: 600;
            letter-spacing: 0.05em;
            box-shadow: 0 6px 14px rgba(251, 140, 0, 0.35);
            transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.2s ease;
            white-space: nowrap;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 18px rgba(251, 140, 0, 0.45);
        }

        button:active {
            transform: translateY(1px);
            box-shadow: 0 3px 8px rgba(251, 140, 0, 0.4);
        }

        .hint {
            margin: 6px 0 0;
            font-size: 12px;
            color: #90a4ae;
        }

        .result {
            margin-top: 18px;
            font-size: 14px;
            line-height: 1.6;
            background-color: #fffde7;
            border-radius: 10px;
            padding: 12px 14px;
            border: 1px solid #ffe082;
            position: relative;
            overflow: hidden;
        }

        .result::before {
            content: "Result";
            position: absolute;
            top: 8px;
            right: 12px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: #ffb300;
            opacity: 0.8;
        }

        .result-main {
            font-size: 14px;
        }

        .result-meta {
            margin-top: 6px;
            font-size: 12px;
            color: #8d6e63;
        }

        .result-tag {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 999px;
            background-color: #fff3e0;
            color: #fb8c00;
            margin-bottom: 4px;
        }

        .result-empty {
            font-size: 13px;
            color: #90a4ae;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="card-header">
            <div class="title-row">
                <span class="emoji">ğŸ¶</span>
                <h1>å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ</h1>
            </div>
            <p class="subtitle">å¹«å¦™éº—æ›ç®—æˆã€Œäººé¡å¹¾æ­²ã€çš„å°å·¥å…· ğŸ’›</p>
        </div>

        <div class="field-group">
            <label for="birthDate">ç‹—ç‹—çš„å‡ºç”Ÿæ—¥æœŸ</label>
            <!-- å¯é å¡«å¦™éº—çš„ç”Ÿæ—¥ï¼Œä½¿ç”¨è€…ä¹Ÿå¯ä»¥è‡ªè¡Œä¿®æ”¹ -->
            <div class="input-row">
                <input type="date" id="birthDate" value="2023-02-28">
                <button id="calcBtn">é–‹å§‹è¨ˆç®—</button>
            </div>
            <p class="hint">Tipï¼šä¿®æ”¹ç”Ÿæ—¥å¾Œå†æŒ‰ã€Œé–‹å§‹è¨ˆç®—ã€å³å¯æ›´æ–°çµæœ</p>
        </div>

        <div id="result" class="result">
            <!-- é€™è£¡æœƒé¡¯ç¤ºé‹ç®—çµæœæˆ–ä¸Šæ¬¡é‹ç®—çµæœ -->
        </div>
    </div>

    <script>
        // localStorage ä½¿ç”¨çš„ key
        var STORAGE_KEY = "miaoliAgeCalc";

        function calculateAges() {
            var birthInput = document.getElementById("birthDate").value;
            var resultEl = document.getElementById("result");

            if (!birthInput) {
                resultEl.innerHTML =
                    '<div class="result-main result-empty">è«‹å…ˆé¸æ“‡å¦™éº—çš„å‡ºç”Ÿæ—¥æœŸï½</div>';
                return;
            }

            var birthDate = new Date(birthInput);
            var today = new Date();

            // æ¸…æ‰æ™‚é–“éƒ¨åˆ†ï¼Œåªæ¯”æ—¥æœŸ
            birthDate.setHours(0, 0, 0, 0);
            today.setHours(0, 0, 0, 0);

            if (birthDate > today) {
                resultEl.innerHTML =
                    '<div class="result-main result-empty">å‡ºç”Ÿæ—¥æœŸä¸èƒ½æ™šæ–¼ä»Šå¤©å”·ï¼</div>';
                return;
            }

            // è¨ˆç®—å¦™éº—å¯¦éš›ç‹—å¹´é½¡ï¼ˆä»¥å¹´ç‚ºå–®ä½ï¼‰
            var diffMs = today.getTime() - birthDate.getTime();
            var dogAge = diffMs / (1000 * 60 * 60 * 24 * 365.25); // ä»¥ 365.25 å¤©ç•¶ä¸€å¹´

            if (dogAge <= 0) {
                resultEl.innerHTML =
                    '<div class="result-main result-empty">å¦™éº—é‚„å¤ªå°å•¦ï¼Œæš«æ™‚ç„¡æ³•è¨ˆç®—ã€‚</div>';
                return;
            }

            // æœ€æ–°å…¬å¼ï¼šhuman_age = 16 * ln(dog_age) + 31
            var humanAge = 16 * Math.log(dogAge) + 31;

            // é¡¯ç¤ºåˆ°ä¸€ä½å°æ•¸
            var dogAgeDisplay = dogAge.toFixed(1);
            var humanAgeDisplay = humanAge.toFixed(1);

            var now = new Date();
            var displayTime =
                now.getFullYear() +
                "-" +
                ("0" + (now.getMonth() + 1)).slice(-2) +
                "-" +
                ("0" + now.getDate()).slice(-2) +
                " " +
                ("0" + now.getHours()).slice(-2) +
                ":" +
                ("0" + now.getMinutes()).slice(-2);

            // æ›´æ–°ç•«é¢
            resultEl.innerHTML =
                '<div class="result-tag">âœ” æœ¬æ¬¡è¨ˆç®—</div>' +
                '<div class="result-main">å¦™éº—ç¾åœ¨å¤§ç´„ <strong>' +
                dogAgeDisplay +
                "</strong> æ­²ç‹—å¹´é½¡ï¼Œ<br>æ›ç®—æˆäººé¡å¹´é½¡å¤§ç´„æ˜¯ <strong>" +
                humanAgeDisplay +
                "</strong> æ­²ã€‚</div>" +
                '<div class="result-meta">è¨ˆç®—æ™‚é–“ï¼š' +
                displayTime +
                "</div>";

            // å°‡çµæœå­˜å…¥ localStorage
            var data = {
                birthDate: birthInput,
                dogAge: dogAgeDisplay,
                humanAge: humanAgeDisplay,
                calcTime: displayTime
            };

            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            } catch (e) {
                // è‹¥ localStorage å¤±æ•—å°±ç•¥éï¼Œä¸å½±éŸ¿ä½¿ç”¨
            }
        }

        // è¼‰å…¥ä¸Šæ¬¡è¨ˆç®—çµæœ
        function loadLastResult() {
            var resultEl = document.getElementById("result");
            var birthInputEl = document.getElementById("birthDate");

            var raw = null;
            try {
                raw = localStorage.getItem(STORAGE_KEY);
            } catch (e) {
                raw = null;
            }

            if (!raw) {
                // ç¬¬ä¸€æ¬¡ä½¿ç”¨æ²’æœ‰è³‡æ–™
                resultEl.innerHTML =
                    '<div class="result-main result-empty">é‚„æ²’æœ‰è¨ˆç®—ç´€éŒ„ï¼Œå…ˆå¹«å¦™éº—ç®—ç®—çœ‹å§ï¼</div>';
                return;
            }

            var data;
            try {
                data = JSON.parse(raw);
            } catch (e) {
                resultEl.innerHTML =
                    '<div class="result-main result-empty">ç´€éŒ„æ ¼å¼æœ‰é»æ€ªæ€ªçš„ï¼Œè«‹é‡æ–°è¨ˆç®—ä¸€æ¬¡ã€‚</div>';
                return;
            }

            if (data.birthDate) {
                birthInputEl.value = data.birthDate;
            }

            if (data.dogAge && data.humanAge) {
                resultEl.innerHTML =
                    '<div class="result-tag">â± ä¸Šæ¬¡è¨ˆç®—çµæœ</div>' +
                    '<div class="result-main">å¦™éº—ç•¶æ™‚å¤§ç´„ <strong>' +
                    data.dogAge +
                    "</strong> æ­²ç‹—å¹´é½¡ï¼Œ<br>æ›ç®—æˆäººé¡å¹´é½¡å¤§ç´„æ˜¯ <strong>" +
                    data.humanAge +
                    "</strong> æ­²ã€‚</div>" +
                    '<div class="result-meta">è¨ˆç®—æ™‚é–“ï¼š' +
                    (data.calcTime || "æ™‚é–“æœªçŸ¥") +
                    "</div>";
            } else {
                resultEl.innerHTML =
                    '<div class="result-main result-empty">ç´€éŒ„ä¸å®Œæ•´ï¼Œè«‹é‡æ–°å¹«å¦™éº—è¨ˆç®—ä¸€æ¬¡ã€‚</div>';
            }
        }

        document.getElementById("calcBtn").addEventListener("click", calculateAges);

        // é é¢è¼‰å…¥å¾Œç«‹å³å˜—è©¦è¼‰å…¥ä¸Šæ¬¡çš„é‹ç®—çµæœ
        window.addEventListener("DOMContentLoaded", loadLastResult);
    </script>
</body>

</html>